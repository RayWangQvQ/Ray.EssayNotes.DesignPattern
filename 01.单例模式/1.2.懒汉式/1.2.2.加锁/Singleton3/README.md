# 加锁懒汉式（线程安全但效率差）

## 优点

* 懒加载

在类被装载时，不会去实例化单例对象，只有当首次调用 GetInstance() 方法时才会去实例化单例对象。

* 线程安全

因为在判断之前加了线程锁，所以在多线程的情况下不会重复创建实例。

在首次调用 GetInstance() 方法时，假如有 2 两个线程同时进入方法，但是因为加了线程锁，所以同一时间只有一个线程可以得到同步锁。

当第一个线程锁加上锁时，第二个线程只能等待。此时第一个线程根据 If 语句判断出单例没有被创建过，是首次访问，于是改线程成功进入 If 内部，并成功实例化了一个单例对象。

然后第一个线程释放同步锁，此时第二个线程可以加上同步锁，并进入到 If 语句。

这时由于单例对象已经不为空了，所以第二个线程不会进入 If 语句内部，就不会重复创建实例对象了。

## 缺点

* 效率差

如果是多线程首次调用 GetInstance() 方法，此时如上描述，不会有效率问题。

但是，在不是首次调用的情况下，以后每次多线程为了获取单例对象去调用 GetInstance() 方法，此时单例对象已存在，理论上只要把这个实例返回给它们就行了，但是现实却是这些线程因为线程锁的原因，每个线程都需要去加一次同步锁，后面的线程都需要排队等待。

而加锁是一个非常耗时的操作，在没必要的时候我们应该尽量避免。